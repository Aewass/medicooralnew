---
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/Navbar.astro';
import Hero from '../../components/Hero.astro';
import Services from '../../components/Services.astro';
import About from '../../components/About.astro';
import History from '../../components/History.astro';
import Team from '../../components/Team.astro';
import Testimonials from '../../components/Testimonials.astro';
import Faq from '../../components/Faq.astro';
import Contact from '../../components/Contact.astro';
import Footer from '../../components/Footer.astro';
import { getLang } from '../../utils/getLang';

// This needs to be exported as a named export
export async function getStaticPaths() {
  return [
    { params: { lang: 'en' } },
  ];
}

const { lang } = Astro.params;

// Make sure lang is 'en' and nothing else
if (lang !== 'en') {
  return Astro.redirect('/');
}

// Use the utility to double-check the language from the URL
const detectedLang = getLang(Astro.url.pathname);
if (detectedLang !== 'en') {
  // Something's wrong with the URL, redirect to the correct one
  return Astro.redirect('/en/');
}
---

<Layout title="Home">
  <Navbar />
  <main>
    <Hero />
    <Services />
    <About />
    <History />
    <Team />
    <Testimonials />
    <Faq />
    <Contact />
  </main>
  <Footer />
</Layout> 